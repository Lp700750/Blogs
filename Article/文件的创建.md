# 文件的创建过程

### 1 文件由上层到底层流程图

>![文件系统_1 drawio](https://github.com/Lp700750/Blogs/assets/104414865/6bb872b1-65f7-4853-9963-061ad5f08612)


### 2 文件创建流程

>- 1 首先在目录当中查看该文件是否存在，
>  - 普通文件：存放的是文件的内容与属性
>  - 目录文件：存放的是各类文件的属性信息
>    - 同时目录文件也有类似文件指针"fd"数组
>    - 在目录里面查找：相当于在目录文件数组里面遍历(在每一个block块的super block里面进行查看，看是否有文件空间余量)
>    - 在目录里面添加文件：相当于在目录文件数组尾插
>- 2 如果在目录当中不存在，那么在目录文件里面添加该文件名
>- 3 在OS层面其实是新增一个inode,在inode bitmap当中找到inode空间将inode信息放进去，在block bitmap里面将文件的内容放进去
>- 4 在底层，将文件的的信息放到硬件下的inode文件结构体当中
>
>**补充：file结构体是和inode的作用是不一样的**
>
>-  inode更多的是存储文件的一些持久化的数据，比如大小，时间、属主，数据块位置等。inode是存在硬盘中的。在操作的文件的时候才会加载到内存。如果有修改，需要回写硬盘。
>- file存储的是文件临时的元数据，他只存在内存里。比如一个文件当前读写位置，打开模式等等。关闭文件后就会丢失这些数据。 
>![文件创建流程图 drawio](https://github.com/Lp700750/Blogs/assets/104414865/e98a9649-f45a-4463-adb2-fe1480481d0d)

>
