# 线程的优点与缺点

### 0 线程概念

>- 是在进程内部运行的一个执行分支（执行流），属于进程的一部分，粒度比进程更加细和轻量化
>  - 线程在进程的地址空间内运行
>  - 线程是CPU调度的基本单位，承担进程资源的一部分的基本实体（进程划分资源给线程）
>
>- 线程和进程的共享和私有，所有的轻量级进程（可能是线程）都是在进程的内部运行（地址空间：标识进程所能看到的大部分资源）
>  - 进程：独立性可以有部分的共享资源（管道，ipc资源）
>  - 线程：大部分的资源时共享的，可以有部分的资源是”私有“的（栈，上下文信息）
>
>- 创建进程要使用的资源是非常多的，是从0到1的过程，然而创建线程的过程则是在1之后进行
>
>![线程的PCB分配情况](https://github.com/Lp700750/Blogs/assets/104414865/e69767e1-ad1d-42ea-9b3c-383094e9cd5c)

### 1 进程的优点

>- 创建一个新线程的代价要比创建一 个新进程小得多（不需要从0到1，线程只需要分配就行）
>- 与进程之间的切换相比，线程之间的切换需要操作系统做的工作要少很多
>- 线程占用的资源要比进程少很多**（线程不怎么申请资源，而是复用进程的资源）**
>- 能充分利用多处理器的可并行数量
>- 在等待慢速I/O操作结束的同时，程序可执行其他的计算任务
>- 计算密集型应用，为了能在多处理器系统上运行，将计算分解到多个线程中实现
>  - 加密，大数据运算等->主要占用的是CPU资源
>  - 该应用线程不是越多越好，过多会导致线程间被过度切换（有成本的）
>- I/O密集型应用，为了提高性能，将I/O操作重叠。 线程可以同时等待不同的I/O操作。
>  - 网络下载，云盘，SSH，在线直播，看电影->内存和外设的IO资源
>  - 网络游戏->CPU和IO密集型这样的应用
>  - 该应用允许更多一点的进程，因为IO比较慢

### 2 进程的缺点

>- 性能损失
>   - 一个很少被外部事件阻塞的计算密集型线程往往无法与共它线程共享同一个处理器。如果计算密集型线程的数量比可用的处理器多，那么可能会有较大的性能损失，这里的性能损失指的是增加了额外的同步和调度开销，而可用的资源不变。
>
>- 健壮性降低
>   - 编写多线程需要更全面更深入的考虑，在一个多线程程序里，因时间分配上的细微偏差或者因共享了不该共享的变量而造成不良影响的可能性是很大的，换句话说线程之间是缺乏保护的。
>
>- 缺乏访问控制
>   - 进程是访问控制的基本粒度,在一个线程中调用某些OS函数会对整个进程造成影响。
>
>- 编程难度提高
>   - 编写与调试一个多线程程序比单线程程序困难得多
